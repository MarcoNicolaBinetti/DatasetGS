---
title: "Replication of Figures: Politics of International Solidarity"
author: "Anon"
date: "12/9/2025"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Instructions

This script uses:

- The main dataset "globsol_df50k_v2_1.rds", for Figures 1 and 2 in the main text.
- The table outputs from the Stata analysis, for Figure 3 and all figures from the Appendix.

Run the Stata do file first before attempting to compile this script, from Figure 3 onward.

# Setup

## Load libraires
```{r}
library(readxl)       
library(ggplot2)      
library(ggtext)   
library(tidyverse)    
library(RColorBrewer) 
library(Hmisc)        
library(data.table)   
library(R.utils)      
library(naniar)       
library(geosphere)    
library(zoo)          
library(rworldmap)    
library(gridExtra)    
library(classInt)     
library(DT)           
library(dvmisc)      
library(gtools)       
library(foreign)      
library(countrycode)  
library(patchwork)    
library(sf)           
library(rnaturalearth)
```

## Remove lists
```{r}
rm(list=ls())
```

# Main text figures 1-3

## Import data for Figure 1 and 2
```{r}
full_df <- readRDS("globsol_df50k_v2_1.rds")
table(full_df$glob_sol)
```

## Plot and export Figure 1
```{r}
df_g <- full_df%>%
mutate(aid_scaled = Hum_plus_ER_aid_tot-cumulative_mean_Hum_plus_ERaid,
        Norm_scaled = NormAgr-cum_mean_NormAgr)

xlim<-mean(df_g$Norm_scaled)
ylim<-mean(df_g$aid_scaled)


p <- ggplot(data=df_g, aes(x = Norm_scaled, y = aid_scaled)) +
 geom_point(aes(colour = factor(GlobSol))) +
 labs(x = "Identification", y = "Joint sharing") +
 geom_vline(xintercept = 0, linetype = "dashed", alpha=0.5) +
 geom_hline(yintercept = 0, linetype = "dashed", alpha=0.5) +
 scale_x_continuous(breaks=c(min(df_g$Norm_scaled)-14,0,max(df_g$Norm_scaled)),
                     labels=c("Low", "Mean","High"),
                     limits=c(min(df_g$Norm_scaled)-5,max(df_g$Norm_scaled)+5)) +
 scale_y_continuous(breaks=c(0,1500000000),
                    limits=c(-181435843,1500000000),
                     labels=c("Mean","High")) + 
 scale_colour_brewer(palette="Set1",name="Global Solidarity",
                     labels=c("Full",
                              "Symbolic",
                              "Transactional",
                              "Minimal")) +
 theme(panel.background = element_blank(),
        axis.ticks=element_blank(),
         axis.text=element_text(size=10),
       legend.text = element_text(size=10),
        legend.position=c(0.8,0.8))

lab <- df_g %>% 
  mutate(label = ifelse(year == "2014" & iso3c == "CHN", "\nYunnan Earthquake,  China 2014", 
                 ifelse(year == "2002" & iso3c == "AUT", "\nAustria Floods, 2002",
                 ifelse(year == "2005" & iso3c == "PAK", " \nKashmir Earthquake,\n Pakistan 2005", NA)))) %>%
  mutate(label2 = ifelse(year == "2006" & iso3c == "SDN", "Sudan\nFloods,\n2006 ", NA)) %>%
  filter(!is.na(label) | !is.na(label2))

Figure1 <- p +
  geom_text(data = lab, aes(x = Norm_scaled, y = aid_scaled, label = label), hjust = 0.6, vjust = 0.8) +
  geom_text(data = lab, aes(x = Norm_scaled, y = aid_scaled, label = label2), hjust = 1.2) +
  geom_point(data = lab, aes(x = Norm_scaled, y = aid_scaled), shape = 1, size = 3) +
  ggtitle("")

ggsave("Figure1.png", Figure1, width = 8, height = 6, dpi=600)

```

## Plot and export Figure 2
```{r}
df<-full_df

df_summary <- df %>%
  group_by(iso3c) %>%
  summarise(
    GlobSol1 = any(GlobSol == 1),
    GlobSol2 = any(GlobSol == 2),
    GlobSol3 = any(GlobSol == 3),
    GlobSol4 = any(GlobSol == 4))


world <- ne_countries(scale = "medium", returnclass = "sf") %>% filter(iso_a3 != "ATA")

# Flag countries not in the dataset as NA
world_data <- world %>%
  left_join(df_summary, by = c("iso_a3" = "iso3c")) %>%
  mutate(
    Present = !is.na(GlobSol1) | !is.na(GlobSol2) | !is.na(GlobSol3) | !is.na(GlobSol4), 
    GlobSol1 = ifelse(Present, GlobSol1, NA),
    GlobSol2 = ifelse(Present, GlobSol2, NA),
    GlobSol3 = ifelse(Present, GlobSol3, NA),
    GlobSol4 = ifelse(Present, GlobSol4, NA))

# Define a function to create maps for each GlobSol category
create_map <- function(data, column, title, fill_color) {
  ggplot(data) +
    geom_sf(aes(fill = !!sym(column)), color = "black") + 
    scale_fill_manual(
      values = c(
        "TRUE" = scales::alpha(fill_color, 1),
        "FALSE" = "white", 
        "NA" = "grey"), # Grey for countries not in dataset
      na.value = "grey") +
    labs(title = title, fill = NULL) +
    theme_void() +
    theme(plot.title = element_text(hjust = 0.5, size = 12, face = "bold"),
          legend.position = "none")
}

map1 <- create_map(world_data, "GlobSol1", "Full Solidarity", "#e41a1c")
map2 <- create_map(world_data, "GlobSol2", "Symbolic Solidarity", "#377eb8")
map3 <- create_map(world_data, "GlobSol3", "Transactional Solidarity", "#4daf4a")
map4 <- create_map(world_data, "GlobSol4", "Minimal Solidarity", "#984ea3")

# Combine maps 
Figure2 <- (map3 + map1) / (map4 + map2) +
  plot_annotation(
    title = "",
    theme = theme(
      plot.title = element_text(hjust = 0.5, size = 16, face = "bold")
    ))

ggsave("Figure2.png", Figure2, width = 8, height = 6, dpi=600)

```

## Import data for Figure 3
```{r}
## 1. Import the raw elasticity table (two-row header, rows for b/ll/ul)
elas_raw <- read_xlsx("elas_Model_main.xlsx",col_names = FALSE)
```

## Plot and export Figure 3
```{r}
## Identify the rows for b, ll, ul by their labels in the first column
row_b  <- which(elas_raw[[1]] == "b")
row_ll <- which(elas_raw[[1]] == "ll")
row_ul <- which(elas_raw[[1]] == "ul")

varnames       <- as.character(elas_raw[1, -1])
outcomes_stata <- as.character(elas_raw[2, -1])

elas_long <- tibble(
  variable      = varnames,
  outcome_stata = outcomes_stata,
  coef          = as.numeric(elas_raw[row_b,  -1]),
  ll95          = as.numeric(elas_raw[row_ll, -1]),
  ul95          = as.numeric(elas_raw[row_ul, -1]))

## Keep only the three IVs of interest and relabel variables + outcomes
elas_plot <- elas_long %>% 
  filter(variable %in% c("ln_dis_death", "ln_gdp_lag_1", "nat_rent")) %>% 
  mutate(
    variable = factor(
      variable,
      levels = c("ln_dis_death", "ln_gdp_lag_1", "nat_rent"),
      labels = c("Disaster fatalities",
                 "Economic size",
                 "Natural rents")),
    outcome = dplyr::case_when(
      outcome_stata == "1bn._predict" ~ "Full Solidarity",
      outcome_stata == "2._predict"   ~ "Symbolic Solidarity",
      outcome_stata == "3._predict"   ~ "Transactional Solidarity",
      outcome_stata == "4._predict"   ~ "Minimal Solidarity",
      TRUE                            ~ outcome_stata),
    outcome = factor(
      outcome,
      levels = c("Full Solidarity",
                 "Symbolic Solidarity",
                 "Transactional Solidarity",
                 "Minimal Solidarity")),
    outcome_display = factor(outcome,
                            levels = c("Transactional Solidarity",
                                      "Full Solidarity", 
                                      "Minimal Solidarity",
                                      "Symbolic Solidarity")))

coef_limits <- range(elas_plot$ll95, elas_plot$ul95, na.rm = TRUE)

## Coefficient (elasticity) plot
figure_elas <- ggplot(elas_plot,
  aes(x = variable,
      y = coef,
      ymin = ll95,
      ymax = ul95,
      color = outcome)) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  geom_pointrange() +
  coord_flip() +
  facet_wrap(~ outcome_display, nrow = 2, ncol = 2, scales = "fixed") +
  scale_y_continuous(limits = coef_limits) +       
  scale_x_discrete(limits = rev)+
  labs(x = NULL,y = "",title = "") +
  scale_color_manual(
    values = c(
      "Full Solidarity"          = "#e41a1c",
      "Symbolic Solidarity"      = "#377eb8",
      "Transactional Solidarity" = "#4daf4a",
      "Minimal Solidarity"       = "#984ea3")) +
  theme_bw(base_size = 16) +
  theme(plot.title = element_text(hjust = 0.5),
        legend.position = "none")

ggsave("Figure3.png",figure_elas,width = 9,height = 5,dpi = 600)

```

# Appendix Figures

## Figure 1A
```{r}
## import  dataset
df_Aiddata_sectoral<- read.csv("AidDataCoreDonorRecipientYearPurpose_ResearchRelease_Level1_v3.0.csv")

df_Aiddata_sectoral$Short_code<-c((substr(( c(df_Aiddata_sectoral$coalesced_purpose_code)), 1, 2)))

## rename codes
replacements <- c(
  "10" = "Social_Infra",
  "11" = "Education",
  "12" = "Health",
  "13" = "Population_Policies",
  "14" = "Water_Supply_Sanitation",
  "15" = "Gov_Civ_Soc",
  "16" = "Soc_Infra",
  "20" = "Eco_Infra",
  "21" = "Trans_Stor",
  "22" = "Comm",
  "23" = "Energy_Gen_Supp",
  "24" = "Banking",
  "25" = "Business",
  "30" = "Production Sectors",
  "31" = "Agri_For_Fish",
  "32" = "Ind_Min_Cons",
  "33" = "Trade_policy",
  "41" = "Env_Protection",
  "42" = "Women",
  "43" = "Other",
  "51" = "Budget_Support",
  "52" = "Food_Security",
  "53" = "Commodity_Assistance",
  "60" = "Debt",
  "70" = "Humanitarian_Aid",
  "72" = "Emergency_Response",
  "73" = "Reconstruction_Relief",
  "74" = "Disaster_Prevention",
  "91" = "Administrative_costs",
  "92" = "Support_NGO",
  "93" = "Refugees_Donor",
  "99" = "Unallocated"
)

# Apply replacements 
df_Aiddata_sectoral$Short_code <- replacements[as.character(df_Aiddata_sectoral$Short_code)]

# change names countries
df_Aiddata_sectoral$recipient[df_Aiddata_sectoral$recipient=="Yugoslavia"]            <- "Serbia"
df_Aiddata_sectoral$recipient[df_Aiddata_sectoral$recipient=="Serbia and Montenegro"] <- "Serbia"
df_Aiddata_sectoral$recipient[df_Aiddata_sectoral$recipient=="Soviet Union"]          <- "Russia"

# assign ISO3
df_Aiddata_sectoral$iso3c <- countrycode(df_Aiddata_sectoral$recipient, "country.name", "iso3c")

# drop iso3c NAs
df_Aiddata_sectoral<-df_Aiddata_sectoral[!is.na(df_Aiddata_sectoral$iso3c), ]

## aggregate at country recipient purpose level
df_Aiddata_sectoral <- df_Aiddata_sectoral %>% 
  dplyr::group_by(iso3c, year, Short_code) %>% 
  dplyr::summarise(commitment_tot = sum(commitment_amount_usd_constant_sum, na.rm = TRUE),
    .groups = "drop")

# Summarize data to identify recipient countries and aid types
df_summary <- df_Aiddata_sectoral %>%
  group_by(iso3c) %>%
  dplyr::summarize(
    Received_Aid = any(commitment_tot > 0),
    Humanitarian_Aid = any(Short_code == "Humanitarian_Aid"),
    Emergency_Response = any(Short_code == "Emergency_Response"),
    Emergency_Humanitarian = any(Short_code %in% c("Humanitarian_Aid", "Emergency_Response"))
  )

# Load and join world map
world <- ne_countries(scale = "medium", returnclass = "sf") %>% filter(iso_a3 != "ATA")

world_data <- world %>%
  left_join(df_summary, by = c("iso_a3" = "iso3c")) %>%
  mutate(
    Received_Aid = replace_na(Received_Aid, FALSE),
    Humanitarian_Aid = replace_na(Humanitarian_Aid, FALSE),
    Emergency_Response = replace_na(Emergency_Response, FALSE),
    Emergency_Humanitarian = replace_na(Emergency_Humanitarian, FALSE)
  )

# Define a function to create maps 
create_map <- function(data, column, title) {
  ggplot(data) +
    geom_sf(aes(fill = !!sym(column)), color = "black") + # Black borders
    scale_fill_manual(
      values = c("TRUE" = "gray", "FALSE" = "white"),
      na.value = "white") +
    labs(title = title, fill = NULL) +
    theme_void() +
    theme(plot.title = element_text(hjust = 0.5, size = 12, face = "bold"),
          legend.position = "none")
}

# Create maps 
map1 <- create_map(world_data, "Received_Aid", "Recipient countries")
map2 <- create_map(world_data, "Humanitarian_Aid", "Humanitarian aid receivers")
map3 <- create_map(world_data, "Emergency_Response", "Emergency response receivers")
map4 <- create_map(world_data, "Emergency_Humanitarian", "Emergency/Humanitarian receivers")

# Combine 
final_plot <- (map1 + map2) / (map3 + map4) +
  plot_annotation(
    title = "AidData: Sample Description",
    theme = theme(
      plot.title = element_text(hjust = 0.5, size = 16, face = "bold")))

ggsave("Figure1A.png", final_plot, width = 8, height = 6)

```


## Figures 8A, 9A, 10A
```{r}
make_coef_plots <- function(dir_path) {
  
  ## Read all coeff_*.xlsx files in the folder 
  files <- list.files(
    path       = dir_path,
    pattern    = "^coeff_.*\\.xlsx$",  
    full.names = TRUE
  )
  
  if (length(files) == 0) {
    stop("No files matching 'coeff_*.xlsx' found in this folder.")
  }
  
  model_names  <- tools::file_path_sans_ext(basename(files))

  model_codes  <- gsub("^coeff_", "", model_names)

  model_labels <- gsub("_", " ", model_codes)
  
  all_coef <- purrr::map2_dfr(
    .x = files,
    .y = model_labels,
    ~ readxl::read_excel(.x) |>
      dplyr::mutate(model = .y))
  
  names(all_coef) <- tolower(names(all_coef))
  
  ## Define custom model order
  main_code <- model_codes[grepl("main", model_codes, ignore.case = TRUE)]
  if (length(main_code) == 0) {
    warning("No 'Main' model detected in filenames; using first file as main.")
    main_code <- model_codes[1]
  } else if (length(main_code) > 1) {
    warning("Multiple 'Main' models detected; using the first one.")
    main_code <- main_code[1]
  }
  
  other_codes <- setdiff(model_codes, main_code)
  num_part <- readr::parse_number(other_codes)
  other_codes_ordered <- other_codes[order(num_part)]
  model_codes_ordered  <- c(main_code, other_codes_ordered)
  model_labels_ordered <- gsub("_", " ", model_codes_ordered)
  main_label           <- gsub("_", " ", main_code)  
  
  coef_clean <- all_coef |>
    dplyr::filter(outcome != 4) |>
    dplyr::mutate(
      model   = factor(model, levels = model_labels_ordered),
      outcome = factor(outcome) 
    )
  
  plot_for_var <- function(var_names, plot_title) {
    
    dat <- coef_clean |>
      dplyr::filter(variable %in% var_names)
    
    dodge <- ggplot2::position_dodge(width = 0.4)
    
    ggplot2::ggplot(dat, ggplot2::aes(x = model, y = coef, colour = outcome)) +
      ggplot2::geom_hline(yintercept = 0, linetype = "dashed") +
      ggplot2::geom_point(position = dodge) +
      ggplot2::geom_errorbar(
        ggplot2::aes(ymin = ll95, ymax = ul95),
        position = dodge,
        width = 0.2) +
      ggplot2::scale_colour_manual(
        name   = "Outcome",
        breaks = c("1", "2", "3"),
        labels = c("Full solidarity",
                   "Symbolic solidarity",
                   "Transactional solidarity"),
        values = c("1" = "#e41a1c",
                   "2" = "#377eb8",
                   "3" = "#4daf4a")
      ) +
      ggplot2::scale_x_discrete(
        labels = function(x) {
          ifelse(
            x == main_label,    
            "**Model 1**",  
            x
          )
        }
      ) +
      ggplot2::labs(
        title = plot_title,
        x     = "Model",
        y     = "Coefficient size"
      ) +
      ggplot2::theme_bw() +
      ggplot2::theme(
        axis.text.y = ggtext::element_markdown(),  
        axis.text.x = ggplot2::element_text()     
      ) +
      ggplot2::coord_flip() 
  }
  
  # Disaster severity: ln_dis_death
  p_ln_dis_death <- plot_for_var(
    var_names  = "ln_dis_death",
    plot_title = "Coefficients for Disaster fatalities"
  )
  
  # Economic size: ln_gdp_lag_1, ln_milper in Models 10A & 12A
  p_ln_gdp_lag_1 <- plot_for_var(
    var_names  = c("ln_gdp_lag_1", "ln_milper"),
    plot_title = "Coefficients for Economic/Military size"
  )
  
  # Rents: nat_rent, strat in Models 11A & 12A
  p_nat_rent <- plot_for_var(
    var_names  = c("nat_rent", "strat"),
    plot_title = "Coefficients for Natural/Strategic rents"
  )
  
  list(
    ln_dis_death = p_ln_dis_death,
    ln_gdp_lag_1 = p_ln_gdp_lag_1,
    nat_rent     = p_nat_rent
  )
}



```

### Create figures (change the folder path)
```{r}
plots <- make_coef_plots("FOLDER_PATH")
```

### Export Figure 8A
```{r}
ggsave(filename = "Figure8A.png", 
  plot     = plots$ln_dis_death,
  width    = 7,  
  height   = 5,
  dpi      = 300)
```

### Export Figure 9A
```{r}
plots$ln_gdp_lag_1

ggsave(filename = "Figure9A.png", 
  plot     = plots$ln_gdp_lag_1,
  width    = 7,  
  height   = 5,
  dpi      = 300)
```

### Export Figure 10A
```{r}
plots$nat_rent

ggsave(filename = "Figure10A.png",  
  plot     = plots$nat_rent,
  width    = 7,  
  height   = 5,
  dpi      = 300)
```

## Figures 11A, 12A, 13A
```{r}
make_elas_plots <- function(dir_path) {

  ## Find all elas_*.xls/xlsx files ----
  files <- list.files(
    path       = dir_path,
    pattern    = "^elas_.*\\.xls[x]?$",
    full.names = TRUE
  )

  if (length(files) == 0) {
    stop("No files matching 'elas_*.xls[x]' found in this folder.")
  }

  model_names <- tools::file_path_sans_ext(basename(files))
  model_codes <- gsub("^elas_", "", model_names)

  model_labels <- gsub("_", " ", model_codes)

  all_elas <- purrr::map2_dfr(
    .x = files,
    .y = model_labels,   
    ~ {
      raw <- readxl::read_excel(.x, col_names = FALSE)

      header_var     <- as.character(raw[1, ])
      header_outcome <- as.character(raw[2, ])

      stat_names <- as.character(raw[[1]])

      b_row  <- which(stat_names == "b")
      ll_row <- which(stat_names == "ll")
      ul_row <- which(stat_names == "ul")

      if (length(b_row) == 0 || length(ll_row) == 0 || length(ul_row) == 0) {
        stop("Could not find rows 'b', 'll', and 'ul' in file: ", .x)
      }

      cols <- 2:ncol(raw)

      tibble::tibble(
        variable = header_var[cols],
        outcome  = header_outcome[cols],
        coef     = as.numeric(unlist(raw[b_row,  cols])),
        ll95     = as.numeric(unlist(raw[ll_row, cols])),
        ul95     = as.numeric(unlist(raw[ul_row, cols])),
        model    = .y         
      )
    }
  )

  ## Define custom model order
  main_code <- model_codes[grepl("main", model_codes, ignore.case = TRUE)]
  if (length(main_code) == 0) {
    warning("No 'Main' model detected in filenames; using first file as main.")
    main_code <- model_codes[1]
  } else if (length(main_code) > 1) {
    warning("Multiple 'Main' models detected; using the first one.")
    main_code <- main_code[1]
  }

  other_codes <- setdiff(model_codes, main_code)
  num_part <- readr::parse_number(other_codes)
  other_codes_ordered <- other_codes[order(num_part)]

  model_codes_ordered  <- c(main_code, other_codes_ordered)
  model_labels_ordered <- gsub("_", " ", model_codes_ordered)
  main_label           <- gsub("_", " ", main_code)  

  elas_clean <- all_elas %>%
    dplyr::mutate(
      variable = tolower(trimws(variable)),
      outcome  = trimws(outcome),
      model    = factor(model, levels = model_labels_ordered)
    ) %>%
    dplyr::filter(
      variable %in% c(
        "ln_dis_death",
        "ln_gdp_lag_1", "ln_milper",   # economic size + replacement
        "nat_rent",    "strat"        # rents + replacement
      ),
      !is.na(coef)
    ) %>%
    dplyr::mutate(
      outcome = factor(
        outcome,
        levels = c("1bn._predict", "2._predict", "3._predict", "4._predict")
      )
    )

  plot_for_var <- function(var_names, plot_title) {

    dat <- elas_clean %>%
      dplyr::filter(variable %in% var_names)

    dodge <- ggplot2::position_dodge(width = 0.4)

    ggplot2::ggplot(dat, ggplot2::aes(x = model, y = coef, colour = outcome)) +
      ggplot2::geom_hline(yintercept = 0, linetype = "dashed") +
      ggplot2::geom_point(position = dodge) +
      ggplot2::geom_errorbar(
        ggplot2::aes(ymin = ll95, ymax = ul95),
        position = dodge,
        width = 0.2
      ) +
      ggplot2::scale_colour_manual(
        name   = "Outcome",
        breaks = c("1bn._predict", "2._predict", "3._predict", "4._predict"),
        labels = c("Full solidarity",
                   "Symbolic solidarity",
                   "Transactional solidarity",
                   "Minimal solidarity"),
        values = c(
          "1bn._predict" = "#e41a1c",  # Full
          "2._predict"   = "#377eb8",  # Symbolic
          "3._predict"   = "#4daf4a",  # Transactional
          "4._predict"   = "#984ea3"   # Minimal 
        )
      ) +

      ggplot2::scale_x_discrete(
        labels = function(x) {
          ifelse(
            x == main_label,    
            "**Model 1**",       
            x
          )
        }
      ) +
      ggplot2::labs(
        title = plot_title,
        x     = "Model",
        y     = "Elasticity"
      ) +
      ggplot2::theme_bw() +
      ggplot2::theme(
        axis.text.y = ggtext::element_markdown()
      ) +
      ggplot2::coord_flip() 
  }

  # Disaster severity
  p_ln_dis_death <- plot_for_var(
    var_names  = "ln_dis_death",
    plot_title = "Semi-elasticities for Disaster fatalities"
  )

  # Economic size
  p_ln_gdp_lag_1 <- plot_for_var(
    var_names  = c("ln_gdp_lag_1", "ln_milper"),
    plot_title = "Semi-elasticities for Economic/Military size"
  )

  # Rents
  p_nat_rent <- plot_for_var(
    var_names  = c("nat_rent", "strat"),
    plot_title = "Semi-elasticities for Natural/Strategic rents"
  )

  list(
    ln_dis_death = p_ln_dis_death,
    ln_gdp_lag_1 = p_ln_gdp_lag_1,
    nat_rent     = p_nat_rent
  )
}



```

### Create figures (change the folder path)
```{r}
elas_plots <- make_elas_plots("FOLDER_PATH")
```

### Export figure 11A
```{r}

ggsave(filename = "Figure11A.png",  
  plot     = elas_plots$ln_dis_death ,
  width    = 7, 
  height   = 5,
  dpi      = 300)
```

### Export figure 12A
```{r}
elas_plots$ln_gdp_lag_1  

ggsave(filename = "Figure12A.png",  
  plot     = elas_plots$ln_gdp_lag_1 ,
  width    = 7,  
  height   = 5,
  dpi      = 300)

```

### Export figure 13A
```{r}
ggsave(filename = "Figure13A.png",  
  plot     = elas_plots$nat_rent ,
  width    = 7,   
  height   = 5,
  dpi      = 300  )
```


